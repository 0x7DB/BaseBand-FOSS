package dev.jess.baseband.client.impl.Modules.Exploits;

import dev.jess.baseband.client.api.Module.Category;
import dev.jess.baseband.client.api.Module.Module;
import dev.jess.baseband.client.api.Utils.ChatUtil;
import net.minecraft.network.Packet;
import net.minecraft.network.play.server.SPacketChat;

import java.awt.*;

public class AntiLog4Shell extends Module {
	public AntiLog4Shell() {
		super("AntiLog4Shell", "Stop tha Exploits", Category.EXPLOITS, new Color(122, 122, 1).getRGB());
	}


	public boolean onPacketReceive(Packet<?> packet) {
		if (packet instanceof SPacketChat) {
			String text = ((SPacketChat) packet).getChatComponent().getUnformattedText();


			if (text.contains("jndi") || text.contains("ldap")) {
				text = text.replace("jndi", "");
				text = text.replace("ldap", "");
				ChatUtil.sendChatMsg("Log4Shell Prevented, Sterilized Message:\n" + text);
				return true;
			}
		}

		return false;
	}
}
